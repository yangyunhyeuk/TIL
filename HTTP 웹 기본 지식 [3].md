# HTTP 상태 코드

- 상태 코드란 클라이언트가 보낸 요청의 처리 상태를 응답에서 알려주는 기능을 의미한다.

1XX : 요청이 수신되어 처리 중이다. 

2XX : 요청이 정상 처리되었다. 

3XX : 요청을 완료하려면 추가 행동이 필요하다. 

4XX : 클라이언트 오류, 잘못된 문법 등으로 서버가 요청을 수행할 수 없는 상태이다. 

5XX : 서버 오류, 서버가 정상 요청을 처리하지 못한다. 



### 클라이언트가 인식할 수 없는 상태 코드를 서버가 반환하는 경우 

클라이언트는 상위 상태 코드로 해석해서 처리한다. 
⇒ “어? 400대 에러네?, 코드가 잘못됐나보다”

1XX : 실무에서 거의 볼 수 없으므로 자세한 설명은 생략한다. 

2XX : 요청이 정상 처리되었다. 

- 200 : 요청이 성공하였다.
- 201 : 요청이 성공하여 새로운 리소스가 생성되었다.
    
    ⇒ “자원이 생성되었고 응답에 Location 헤더가 있을 수도 있겠구나”
    
- 202 : 요청이 접수되었으나, 처리가 완료되지 않았다.
- 204 : 서버가 요청을 성공적으로 수행했으나, 응답 페이로드 본문에 보낼 데이터가 없다.
    
    ⇒ 웹 문서 편집기에서 저장 버튼을 누를 시, 서버에서 저장 로직을 수행한 뒤 결과를 반환할 필    요없는 경우가 이에 해당한다. 
    

3XX : 클라이언트가 서버에 요청할 시 요청을 완료하기 위해 클라이언트 추가 조치가 필요합니다.

- 리다이렉션의 의미
    - 웹 브라우저는 3XX 응답의 결과에 Location 헤더가 있을 경우 Location 위치로 자동으로 이동하는 것을 의미한다.
- 리다이렉션의 종류
    1. 영구 리다이렉션 : 특정 리소스의 URI가 영구적으로 이동하는 것으로 원래의 URL은 사용하지 않는다.  
        1. 301 : 리다이렉트 시에 요청 메서드가 GET으로 변하고 본문이 제거될 수도 있다.
        2. 308 : 리다이렉트 시에 요청 메서드와 본문이 유지된다. 
    2. 일시 리다이렉션 : 일시적으로 잠깐 이동할 때 쓰이는 경우
        
        ⇒ 주문한 뒤에 주문 내역 화면으로 이동하는 경우 
        
        1. 302 :  리다이렉트 시 요청메서드가 get으로 변하고 본문이 제거될 수 있다.
        2. 303 : 리다이렉트 시 요청메서드와 본문이 유지되며 요청 메서드를 변경하면 안된다. 
        3. 307 : 리다이렉트 시 요청 메서드가 get으로 변경된다. 
    3. 특수 리다이렉션 : 결과 대신 캐시를 사용

- 일시적인 리다이렉션 예시 [PRG : Post Redirect Get]
    - post로 주문 후에 웹 브라우저 새로고침하면
    - 새로고침은 다시 요청되어
    - 중복 주문이 될 수 있다.
    
    - post로 주문 후에 새로고침으로 인한 중복 주문 방지
    - post로 주문 후에 주문 결과 화면을 get 메서드로 리다이렉트
    - 새로고침해도 결과 화면을 get으로 조회
    - 중복 주문 대신에 결과 화면만 get으로 다시 요청
    
    ⇒ 생각보다 클라이언트는 주문이 완료된 상태에서 새로고침을 자주 하기에, post가 아닌 get 방식으로 클라이언트 측에서 1차적으로 이슈를 해결한다. 이후에 물론 서버에서도 방지해야 한다. 
    

4XX : 클라이언트 오류, 잘못된 문법 등으로 서버가 요청을 수행할 수 없는 상태이다. 

- 400 : 요청 파라미터가 잘못되거나, API 스펙이 맞지 않는 클라이언트의 잘못된 요청이 원인
- 401 : 클라이언트가 해당 리소스에 대한 인증이 필요하다.
    - 인증(Authentication) : 본인이 누구인지 확인하는 것으로 로그인이 그 예이다.
    - 인가(Authorization) : admin 권한처럼 특정 리소스에 접근할 수 있는 권한인증이 있어야 한다.
- 403 : 서버가 요청을 이해했으나, 승인을 거부하는 경우로 admin 등급이 아닌 사용자가 접근 권한이 없는 리소스에 접근하는 경우가 이에 해당한다.
- 404 : 요청 리소스가 서버에 없는 경우가 해당한다.

5XX : 서버 오류, 서버가 정상 요청을 처리하지 못한다. 

- 500 : 서버 내부 문제로 오류가 발생한 경우
- 503 : 서버가 일시적인 과부하 또는 예정된 작업으로 잠시 요청을 처리할 수 없는 경우

---

## HTTP 헤더 1

http 헤더는 http 전송에 필요한 모든 부가정보를 의미한다

- 헤더 분류
    - General 헤더 : 메시지 전체에 적용되는 정보
    - Request 헤더 : 요청 정보
    - Response 헤더 : 응답 정보
        - Server : Apache
    - Entity 헤더 : 엔티티 바디 정보
        - Content-type, Content-Length

### http BODY

- 메시지 본문( =페이로드)은 엔티티 본문을 전달하는 데 사용된다
- 엔티티 본문은 요청이나 응답에서 전달할 실제 데이터이다.
- 엔티티 헤더는 엔티티 본문의 데이터를 해석할 수 있는 정보를 제공한다.
https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7cc1ccf8-f80b-4952-89ac-89e6733dfe1f/Untitled.png

---

## 표현

- 2014년에 RFC7230, 7235 표준이 나오며, 엔티티라는 용어가 사라지고 “표현”이 대신 사용된다.

- 표현 = 표현 메타데이터 + 표현 데이터

- 표현은 요청이나 응답에서 전달할 실제 데이터를 의미한다.
- 표현 헤더는 표현 데이터를 해석할 수 있는 정보를 제공하며 데이터 유형, 데이터 길이, 압축 정보 등이 이에 해당된다.

1. Content-Type : 표현 데이터 형식
2. Content-Encoding : 표현 데이터 압축 방식
3. Content-Language : 표현 데이터의 자연 언어
4. Content-Length : 표현 데이터의 길이
    
    - 참고로 표현 헤더는 전송과 응답에서 사용된다. 
    

---

### 전송 방식

- 단순 전송
    - Content의 길이를 지정하여 단순하게 보내는 전송 행위
- 압축 전송
    - Content-Encoding에 압축 방식을 명시하여 보내는 전송 행위
- 분할 전송
    - 데이터를 분할하여 쪼개 보내는 방식으로 Content-Length가 예상이 안되기에 명시하지 않아야 한다.
- 범위 전송
    - 전송하려는 데이터의 특정범위의 데이터를 지정하여 보내는 행위

---

### http 정보성 헤더

1. From : 유저 정보의 이메일 정보를 의미하며 일반적으로 사용하지 않는다. 
2. Referer : 이전 웹페이지의 주소를 의미하며 유입 경로 분석이 가능하다. 
3. User-Agent : 클라이언트 애플리케이션 정보, 특정 브라우저에서 장애가 발생하는지 파악이 가능하다. 
4. Server : 요청을 처리하는 origin 서버의 sw 정보 
5. Date : 메시지가 발생한 날짜와 시간

---

### http 특별한 정보성 헤더

1. Host : 요청에서 사용되는 필수값 헤더로, 하나의 IP 주소에 여러 도메인을 한 번에 처리해야 할 때 빛을 바랜다. 
2. Location : 페이지 리다이렉션
3. Allow : 허용 가능한 http 메서드로, get, head, put이 이에 해당한다. 
4. Retry-After : 유저 에이전트가 다음 요청을 하기까지 기다려야 하는 시간

---

### 인증

Authorization : 클라이언트 인증 정보를 서버에 전달

WWW-Authenticate : 리소스 접근 시 필요한 인증 방법 정의

---

### 쿠키

Set-Cookie : 서버에서 클라이언트로 쿠키를 전달(응답)한다.

Cookie : 클라이언트가 서버에서 받은 쿠키를 저장하고, http 요청 시 서버로 전달한다. 

 

- 사용처
    - 사용자 로그인 세션 관리
    - 광고 정보 트래킹
    
- 쿠키 정보는 항상 서버에 전송된다
    - 네트워크 트래픽 추가 유발
    - 최소한의 정보만 사용해야 한다. (로그인한 클라이언트의 세션 id, 인증 토큰)
    - 서버에 전송하지 않고 클라이언트 측에 들고 싶다하면 웹 스토리지 참고

- 쿠키 종류
    - 세션 쿠키 : 만료 날짜를 생략하면 브라우저 종료 시 까지만 유지
    - 영속 쿠키 : 만료 날짜를 입력하면 해당 날짜까지 유지

- 쿠키는 도메인과 경로를 지정하여 컨트롤 할 수 있다.

- 쿠키는 http, https를 구분하지 않고 전송하나, Secure 적용 시 https인 경우에만 전송한다.
- httpOnly : XSS 공격 방지, HTTP 전송에만 사용하며 JS에서 접근이 불가하다.
- SameSite : XSRF 공격 방지, 요청 도메인과 쿠키에 설정된 도메인이 같은 경우에만 쿠키 전송

---

##
